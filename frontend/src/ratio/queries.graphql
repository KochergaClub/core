fragment TrainingForPicker on RatioTraining {
  id
  slug
  name
}

fragment RatioPayment on RatioPayment {
  id
  amount
  payment_type
  status
  fiscalization_status
}

fragment RatioTicket on RatioTicket {
  id
  email
  first_name
  last_name
  payment_amount
  status
  ticket_type
  registration_date
  payments {
    ...RatioPayment
  }
}

fragment RatioPromocode on RatioPromocode {
  id
  code
  discount
  discount_percent
  uses_max
  uses_count
}

fragment RatioTicketTypePromocodes on RatioPromocodeConnection {
  pageInfo {
    ...PageInfo
  }
  edges {
    node {
      ...RatioPromocode
    }
  }
}

fragment RatioTicketType on RatioTicketType {
  id
  price
  name
  discount_by_email
  discount_percent_by_email
  promocodes_count
  promocodes(first: 5) {
    ...RatioTicketTypePromocodes
  }
}

fragment RatioTicketType_Summary on RatioTicketType {
  id
  price
  name
}

fragment RatioTraining_Summary on RatioTraining {
  id
  slug
  name
  date
  telegram_link
  tickets_count
  total_income
  ticket_types {
    ...RatioTicketType_Summary
  }
}

fragment RatioTraining on RatioTraining {
  id
  slug
  name
  date
  telegram_link
  tickets_count
  total_income
  tickets {
    ...RatioTicket
  }
  ticket_types {
    ...RatioTicketType
  }
}

fragment RatioTrainer on RatioTrainer {
  id
  short_name
  long_name
}

fragment Activity on RatioActivity {
  id
  time
  activity_type
  name
  location
  trainer {
    ...RatioTrainer
  }
}

fragment TrainingDay on RatioTrainingDay {
  id
  date
  activities {
    ...Activity
  }
}

fragment TrainingWithSchedule on RatioTraining {
  ...RatioTraining
  schedule {
    ...TrainingDay
  }
}

query RatioTrainings(
  $before: String
  $after: String
  $first: Int
  $last: Int
  $eternal: Boolean
) {
  trainings: ratioTrainings(
    before: $before
    after: $after
    first: $first
    last: $last
    filter: { eternal: $eternal }
  ) {
    pageInfo {
      ...PageInfo
    }
    edges {
      node {
        ...RatioTraining_Summary
      }
    }
  }
}

query RatioTrainingsForPicker(
  $before: String
  $after: String
  $first: Int
  $last: Int
) {
  trainings: ratioTrainings(
    before: $before
    after: $after
    first: $first
    last: $last
    filter: { eternal: false }
  ) {
    pageInfo {
      ...PageInfo
    }
    edges {
      node {
        ...TrainingForPicker
      }
    }
  }
}

query RatioTrainingBySlug($slug: String!) {
  training: ratioTrainingBySlug(slug: $slug) {
    ...RatioTraining
  }
}

query RatioTrainingWithSchedule($slug: String!) {
  training: ratioTrainingBySlug(slug: $slug) {
    ...TrainingWithSchedule
  }
}

query RatioTrainers {
  trainers: ratioTrainersAll {
    ...RatioTrainer
  }
}

query RatioTrainingEmailPrototype($training_id: ID!, $type: String!) {
  content: ratioTrainingEmailPrototype(training_id: $training_id, type: $type)
}

mutation RatioAddTraining($params: RatioAddTrainingInput!) {
  ratioAddTraining(params: $params) {
    ...RatioTraining
  }
}

mutation RatioAddTicket($params: RatioAddTicketInput!) {
  ratioAddTicket(input: $params) {
    ...RatioTicket
  }
}

mutation RatioPaymentAdd($params: RatioPaymentAddInput!) {
  ratioPaymentAdd(input: $params) {
    payment {
      ...RatioPayment
    }
  }
}

mutation RatioPaymentDelete($payment_id: ID!) {
  ratioPaymentDelete(payment_id: $payment_id) {
    ok
  }
}

mutation RatioPaymentSetStatus($input: RatioPaymentSetStatusInput!) {
  ratioPaymentSetStatus(input: $input) {
    payment {
      ...RatioPayment
    }
  }
}

mutation RatioPaymentFiscalize($payment_id: ID!) {
  ratioPaymentFiscalize(payment_id: $payment_id)
}

mutation RatioPaymentFiscalizedManually($payment_id: ID!) {
  ratioPaymentFiscalizedManually(payment_id: $payment_id) {
    payment {
      ...RatioPayment
    }
  }
}

mutation RatioTrainingAddDay($params: RatioTrainingAddDayInput!) {
  ratioTrainingAddDay(params: $params)
}

mutation RatioTrainingCopyScheduleFrom(
  $params: RatioTrainingCopyScheduleFromInput!
) {
  ratioTrainingCopyScheduleFrom(params: $params)
}

mutation RatioTrainingSendEmail($input: RatioTrainingSendEmailInput!) {
  email: ratioTrainingSendEmail(input: $input) {
    draft_link
  }
}

mutation RatioTrainingSyncParticipantsToMailchimp($training_id: ID!) {
  ratioTrainingSyncParticipantsToMailchimp(training_id: $training_id)
}
