fragment WagtailBlockValidationError on WagtailBlockValidationError {
  block_id
  error_message
}

fragment WagtailStreamFieldValidationError on WagtailStreamFieldValidationError {
  non_block_error
  block_errors {
    ...WagtailBlockValidationError
  }
}

mutation WagtailSavePage($input: WagtailEditPageBodyBlocksInput!) {
  result: wagtailEditPageBodyBlocks(input: $input) {
    page {
      id
    }
    validation_error {
      ...WagtailStreamFieldValidationError
    }
  }
}

fragment StructureL1 on WagtailBlockStructure {
  label
  ... on WagtailListBlockStructure {
    child_block {
      label
    }
  }
  ... on WagtailStructBlockStructure {
    child_blocks {
      name
      definition {
        label
      }
    }
  }
}

fragment StructureL2 on WagtailBlockStructure {
  label
  ... on WagtailListBlockStructure {
    child_block {
      ...StructureL1
    }
  }
  ... on WagtailStructBlockStructure {
    child_blocks {
      name
      definition {
        ...StructureL1
      }
    }
  }
}

fragment StructureL3 on WagtailBlockStructure {
  label
  ... on WagtailListBlockStructure {
    child_block {
      ...StructureL2
    }
  }
  ... on WagtailStructBlockStructure {
    child_blocks {
      name
      definition {
        ...StructureL2
      }
    }
  }
}

query WagtailBlockStructure($name: String!) {
  result: wagtailBlockStructure(input: { name: $name }) {
    ...StructureL3
  }
}
