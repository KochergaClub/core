fragment EventsPublicEvent_Summary on EventsPublicEvent {
  event_id
  title
  summary
  image: image_rendition(spec: "fill-760x200") {
    id
    url
  }
  image_2x: image_rendition(spec: "fill-1520x400") {
    id
    url
  }
  start
}

query UpcomingPublicEvents($today: String!) {
  publicEvents(from_date: $today, first: 20) {
    pageInfo {
      hasNextPage
    }
    nodes {
      ...EventsPublicEvent_Summary
    }
  }
}

fragment TeamCalendarEvent on EventsEvent {
  id
  start
  end
  title
  summary
  description
  event_type
  room
  creator
  announcements {
    vk {
      link
    }
    fb {
      link
    }
    timepad {
      link
    }
  }
}

query EventsInRange($start: String!, $end: String!) {
  events(after: $start, before: $end, first: 100) {
    nodes {
      ...TeamCalendarEvent
    }
  }
}

query TeamCalendarEvent($id: ID!) {
  event(event_id: $id) {
    ...TeamCalendarEvent
  }
}

mutation ResizeEvent($id: ID!, $start: String!, $end: String!) {
  result: eventUpdate(input: { event_id: $id, start: $start, end: $end }) {
    event {
      ...TeamCalendarEvent
    }
  }
}

mutation TeamCalendarCreateEvent(
  $start: String!
  $end: String!
  $title: String!
  $description: String!
  $room: String!
) {
  result: eventCreate(
    input: {
      title: $title
      start: $start
      end: $end
      description: $description
      location: $room
    }
  ) {
    ok
    event {
      ...TeamCalendarEvent
    }
  }
}

mutation TeamCalendarUpdateEvent(
  $id: ID!
  $title: String
  $description: String
  $location: String
) {
  result: eventUpdate(
    input: {
      event_id: $id
      title: $title
      description: $description
      location: $location
    }
  ) {
    ok
    event {
      ...TeamCalendarEvent
    }
  }
}

mutation TeamCalendarDeleteEvent($id: ID!) {
  result: eventDelete(input: { event_id: $id }) {
    ok
  }
}
