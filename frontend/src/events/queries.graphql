fragment EventsPublicEvent_Summary on EventsPublicEvent {
  event_id
  title
  summary
  image: image_rendition(spec: "fill-760x200") {
    id
    url
  }
  image_2x: image_rendition(spec: "fill-1520x400") {
    id
    url
  }
  start
}

query UpcomingPublicEvents($today: String!) {
  publicEvents(from_date: $today, first: 20) {
    pageInfo {
      hasNextPage
    }
    nodes {
      ...EventsPublicEvent_Summary
    }
  }
}

fragment TeamCalendarEvent on EventsEvent {
  id
  start
  end
  title
  summary
  description
  event_type
  room
  creator
  announcements {
    vk {
      link
    }
    fb {
      link
    }
    timepad {
      link
    }
  }
}

query EventsInRange($start: String!, $end: String!) {
  events(after: $start, before: $end, first: 100) {
    nodes {
      ...TeamCalendarEvent
    }
  }
}

query TeamCalendarEvent($id: ID!) {
  event(event_id: $id) {
    ...TeamCalendarEvent
  }
}

mutation ResizeEvent($id: ID!, $start: String!, $end: String!) {
  result: eventUpdate(input: { event_id: $id, start: $start, end: $end }) {
    event {
      ...TeamCalendarEvent
    }
  }
}

mutation TeamCalendarCreateEvent(
  $start: String!
  $end: String!
  $title: String!
  $description: String!
  $room: String!
) {
  result: eventCreate(
    input: {
      title: $title
      start: $start
      end: $end
      description: $description
      location: $room
    }
  ) {
    ok
    event {
      ...TeamCalendarEvent
    }
  }
}

mutation TeamCalendarUpdateEvent(
  $id: ID!
  $title: String
  $description: String
  $location: String
) {
  result: eventUpdate(
    input: {
      event_id: $id
      title: $title
      description: $description
      location: $location
    }
  ) {
    ok
    event {
      ...TeamCalendarEvent
    }
  }
}

mutation TeamCalendarDeleteEvent($id: ID!) {
  result: eventDelete(input: { event_id: $id }) {
    ok
  }
}

fragment TeamEventFeedback on EventsFeedback {
  id
  overall_score
  recommend_score
  content_score
  conductor_score
  source_friend
  source_vk
  source_fb
  source_timepad
  source_email
  source_website
  custom_source
  comment
}

fragment TeamEventDetails on EventsEvent {
  ...TeamCalendarEvent
  feedbacks {
    ...TeamEventFeedback
  }
}

query TeamEventDetails($id: ID!) {
  event(event_id: $id) {
    ...TeamEventDetails
  }
}

mutation EventFeedbackCreate(
  $event_id: ID!
  $overall_score: Int
  $recommend_score: Int
  $content_score: Int
  $conductor_score: Int
  $source_friend: Boolean!
  $source_vk: Boolean!
  $source_fb: Boolean!
  $source_timepad: Boolean!
  $source_email: Boolean!
  $source_website: Boolean!
  $custom_source: String!
  $comment: String!
) {
  result: eventsFeedbackCreate(
    input: {
      event_id: $event_id
      overall_score: $overall_score
      recommend_score: $recommend_score
      content_score: $content_score
      conductor_score: $conductor_score
      source_friend: $source_friend
      source_vk: $source_vk
      source_fb: $source_fb
      source_timepad: $source_timepad
      source_email: $source_email
      source_website: $source_website
      custom_source: $custom_source
      comment: $comment
    }
  ) {
    ok
    feedback {
      ...TeamEventFeedback
    }
  }
}

mutation EventFeedbackDelete($id: ID!) {
  result: eventsFeedbackDelete(input: { id: $id }) {
    ok
  }
}
