fragment Membership on MyCmCustomer {
  card_id
  orders_count
  subscription_until
  privacy_mode
  orders {
    start_dt
  }
}

fragment EmailSubscriptionInterest on MyEmailSubscriptionInterest {
  id
  name
  subscribed
}

fragment EmailSubscription on MyEmailSubscription {
  status
  interests {
    ...EmailSubscriptionInterest
  }
}

fragment MyTicket on MyEventsTicket {
  zoom_link
  event {
    event_id
    start
    title
  }
}

fragment MyPage on My {
  user {
    email
    is_staff
  }
  membership {
    ...Membership
  }
  tickets(first: 100) {
    nodes {
      ...MyTicket
    }
  }
  email_subscription {
    ...EmailSubscription
  }
}

query MyPage {
  my {
    ...MyPage
  }
}

mutation MyEmailResubscribe {
  myEmailResubscribe
}

mutation MyEmailUnsubscribe {
  myEmailUnsubscribe
}

mutation MyEmailSubscribeToInterest($interest_id: ID!) {
  myEmailSubscribeToInterest(interest_id: $interest_id)
}

mutation MyEmailUnsubscribeFromInterest($interest_id: ID!) {
  myEmailUnsubscribeFromInterest(interest_id: $interest_id)
}

mutation MyPrivacyModeSet($mode: String!) {
  myPrivacyModeSet(mode: $mode)
}

mutation MyTicketDelete($event_id: ID!) {
  myEventsTicketUnregister(event_id: $event_id) {
    created
  }
}

mutation Logout {
  result: authLogout {
    ok
  }
}

mutation SetPassword($old_password: String, $new_password: String!) {
  result: authSetPassword(input: {
      old_password: $old_password
      new_password: $new_password
  }) {
    ok
    error
  }
}
